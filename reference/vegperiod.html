<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Determine vegetation period — vegperiod • vegperiod</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Determine vegetation period — vegperiod" />
<meta property="og:description" content="Calculate start and end date of vegetation periods based on daily average
air temperature and the day of the year (DOY).
The sum of day degrees within vegetation periods is calculated for
convenience sake." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">vegperiod</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.1.901</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/rnuske/vegperiod/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Determine vegetation period</h1>
    <small class="dont-index">Source: <a href='https://github.com/rnuske/vegperiod/blob/master/R/vegperiod.R'><code>R/vegperiod.R</code></a></small>
    <div class="hidden name"><code>vegperiod.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculate start and end date of vegetation periods based on daily average
air temperature and the day of the year (DOY).
The sum of day degrees within vegetation periods is calculated for
convenience sake.</p>
    </div>

    <pre class="usage"><span class='fu'>vegperiod</span><span class='op'>(</span>
  <span class='va'>dates</span>,
  <span class='va'>Tavg</span>,
  <span class='va'>start.method</span>,
  <span class='va'>end.method</span>,
  Tsum.out <span class='op'>=</span> <span class='cn'>FALSE</span>,
  species <span class='op'>=</span> <span class='cn'>NULL</span>,
  est.prev <span class='op'>=</span> <span class='fl'>0</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>dates</th>
      <td><p>vector of calendar dates (objects of class <code>Date</code>
or something understood by <code><a href='https://rdrr.io/r/base/as.Date.html'>as.Date</a></code>). Must contain
entire years if <code>est.prev &gt; 0</code> else the first year may
comprise only November and December.</p></td>
    </tr>
    <tr>
      <th>Tavg</th>
      <td><p>vector of daily average air temperatures in degree Celsius.
Same length as <code>dates</code>.</p></td>
    </tr>
    <tr>
      <th>start.method</th>
      <td><p>name of method to use for vegetation start.
One of <samp>"Menzel"</samp> (needs additional argument
<code>species</code>, see below), <samp>"StdMeteo"</samp> resp. <samp>"ETCCDI"</samp>,
<samp>"Ribes uva-crispa"</samp>. Can be abbreviated (partial matching).
For further discussion see Details.</p></td>
    </tr>
    <tr>
      <th>end.method</th>
      <td><p>name of method to use for vegetation end.
One of <samp>"vonWilpert"</samp>, <samp>"LWF-BROOK90"</samp>,
<samp>"NuskeAlbert"</samp> and <samp>"StdMeteo"</samp> resp. <samp>"ETCCDI"</samp>.
Can be abbreviated (partial matching).
For further discussion see Details.</p></td>
    </tr>
    <tr>
      <th>Tsum.out</th>
      <td><p>boolean. Return the sum of day degrees within
vegetation period.</p></td>
    </tr>
    <tr>
      <th>species</th>
      <td><p>name of tree species [required if <code>start.method='Menzel'</code>
       ignored otherwise].</p>
<p>Must be one of <samp>"Larix decidua"</samp>, <samp>"Picea abies (frueh)"</samp>,
       <samp>"Picea abies (spaet)"</samp>, <samp>"Picea abies (noerdl.)"</samp>,
       <samp>"Picea omorika"</samp>, <samp>"Pinus sylvestris"</samp>, <samp>"Betula
       pubescens"</samp>, <samp>"Quercus robur"</samp>, <samp>"Quercus petraea"</samp>,
       <samp>"Fagus sylvatica"</samp>.</p></td>
    </tr>
    <tr>
      <th>est.prev</th>
      <td><p>number of years to <strong>est</strong>imate <strong>prev</strong>ious year's
       chill days for the first year
       [required if <code>start.method='Menzel'</code> ignored otherwise].</p>
<p><samp>Menzel</samp> requires the number of chill days of previous November
       and December. If <code>est.prev = 0</code> the first year is used to get
       the previous year's chill days and dropped afterwards. Thus, a year
       from the time series is lost. To avoid losing a year,
       <code>est.prev = n</code> estimates the previous year's chill days for the
       first year from the average of <code>n</code> first years of the time series.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data.frame with year and DOY of start and end day of
  vegetation period. If <code>Tsum.out=TRUE</code>, the data.frame contains an
  additional column with the sum of day degrees within vegetation periods.</p>
    <h2 class="hasAnchor" id="start-methods"><a class="anchor" href="#start-methods"></a>Start methods</h2>

    

<p>The method <b><samp>"Menzel"</samp></b> implements the algorithm described in
Menzel (1997). The method is parameterized for 10 common tree species. It
needs previous year's chill days. <b><samp>"ETCCDI"</samp></b> resp.
<samp>"StdMeteo"</samp> is a simple threshold based procedure as defined by the
Expert Team on Climate Change Detection and Indices (cf. ETCCDI 2009, Frich
et al. 2002, Zhang et al. 2011) leading to quite early vegetation starts.
This method is widely used in climate change studies. The method
<b><samp>"Ribes uva-crispa"</samp></b> is based on leaf-out of gooseberry (Janssen
2009). It was developed by the Germany's National Meteorological Service
(Deutscher Wetterdienst, DWD) and is more robust against early starts than
common simple meteorological procedures.</p>
    <h2 class="hasAnchor" id="end-methods"><a class="anchor" href="#end-methods"></a>End methods</h2>

    

<p>The end method <b><samp>"vonWilpert"</samp></b> is based on von Wilpert (1990). It
was originally developed for "Picea abies" in the Black Forest but is
commonly used for all tree species throughout Germany. As usual, the rules
regarding the soilmatrix are neglected in this implementation.
<b><samp>"LWF-BROOK90"</samp></b> is -for the sake of convenience- a
reimplementation of the LWF-BROOK90 VBA (version 3.4) variant of "vonWilpert"
(Hammel and Kennel 2001). Their interpretation of von Wilpert (1990) and the
somewhat lower precision of VBA was mimicked. <b><samp>"NuskeAlbert"</samp></b>
provide a very simple method which is inspired by standard climatological
procedures but employs a 7 day moving average and a 5 °C threshold (cf.
Walther and Linderholm 2006). <b><samp>"ETCCDI"</samp></b> resp. <samp>"StdMeteo"</samp>
is a simple threshold based procedure as defined by the Expert Team on
Climate Change Detection and Indices (cf. ETCCDI 2009, Frich et al. 2002,
Zhang et al. 2011) leading to quite late vegetation ends.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>ETCCDI (2009)
  Climate Change Indices: Definitions of the 27 core indices.
  <a href='http://etccdi.pacificclimate.org/list_27_indices.shtml'>http://etccdi.pacificclimate.org/list_27_indices.shtml</a></p>
<p>Frich, P., Alexander, L., Della-Marta, P., Gleason, B., Haylock, M.,
  Klein Tank, A. and Peterson, T. (2002)
  Observed coherent changes in climatic extremes during the second half of
  the twentieth century.
  <em>Climate Research</em>, <b>19</b>, 193--212.
  doi: <a href='https://doi.org/10.3354/cr019193'>10.3354/cr019193</a>
.</p>
<p>Hammel, K. and Kennel, M. (2001)
  Charakterisierung und Analyse der Wasserverfügbarkeit und des
  Wasserhaushalts von Waldstandorten in Bayern mit dem Simulationsmodell
  BROOK90.
  <em>Forstliche Forschungsberichte München</em>.</p>
<p>Janssen, W. (2009)
  Definition des Vegetationsanfanges.
  <em>Internal Report, Deutscher Wetterdienst, Abteilung Agrarmeteorologie</em>.</p>
<p>Menzel, A. (1997)
  Phänologie von Waldbäumen unter sich ändernden Klimabedingungen -
  Auswertung der Beobachtungen in den Internationalen Phänologischen Gärten
  und Möglichkeiten der Modellierung von Phänodaten.
  <em>Forstliche Forschungsberichte München</em>.</p>
<p>von Wilpert, K. (1990)
  Die Jahrringstruktur von Fichten in Abhängigkeit vom Bodenwasserhaushalt
  auf Pseudogley und Parabraunerde: Ein Methodenkonzept zur Erfassung
  standortsspezifischer Wasserstreßdispostion.
  <em>Freiburger Bodenkundliche Abhandlungen</em>.</p>
<p>Walther, A. and Linderholm, H. W. (2006)
  A comparison of growing season indices for the Greater Baltic Area.
  <em>International Journal of Biometeorology</em>, <b>51</b>(2), 107--118.
  doi: <a href='https://doi.org/10.1007/s00484-006-0048-5'>10.1007/s00484-006-0048-5</a>
.</p>
<p>Zhang, X., Alexander, L., Hegerl, G. C., Jones, P., Tank, A. K.,
  Peterson, T. C., Trewin, B. and Zwiers, F. W. (2011)
  Indices for monitoring changes in extremes based on daily temperature and
  precipitation data.
  <em>Wiley Interdisciplinary Reviews: Climate Change</em>, <b>2</b>(6), 851--870.
  doi: <a href='https://doi.org/10.1002/wcc.147'>10.1002/wcc.147</a>
.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>goe</span><span class='op'>)</span>
<span class='fu'>vegperiod</span><span class='op'>(</span>dates<span class='op'>=</span><span class='va'>goe</span><span class='op'>$</span><span class='va'>date</span>, Tavg<span class='op'>=</span><span class='va'>goe</span><span class='op'>$</span><span class='va'>t</span>,
          start.method<span class='op'>=</span><span class='st'>"Menzel"</span>, end.method<span class='op'>=</span><span class='st'>"vonWilpert"</span>,
          species<span class='op'>=</span><span class='st'>"Picea abies (frueh)"</span>, est.prev<span class='op'>=</span><span class='fl'>5</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    year start end
#&gt; 1  2001   119 274
#&gt; 2  2002   127 279
#&gt; 3  2003   125 279
#&gt; 4  2004   116 279
#&gt; 5  2005   124 279
#&gt; 6  2006   126 271
#&gt; 7  2007   124 279
#&gt; 8  2008   125 279
#&gt; 9  2009   115 279
#&gt; 10 2010   116 279</div><div class='input'>
<span class='co'># take chill days from first year, which is then dropped</span>
<span class='fu'>vegperiod</span><span class='op'>(</span>dates<span class='op'>=</span><span class='va'>goe</span><span class='op'>$</span><span class='va'>date</span>, Tavg<span class='op'>=</span><span class='va'>goe</span><span class='op'>$</span><span class='va'>t</span>, start<span class='op'>=</span><span class='st'>"Menzel"</span>, end<span class='op'>=</span><span class='st'>"vonWilpert"</span>,
          species<span class='op'>=</span><span class='st'>"Picea abies (frueh)"</span>, est.prev<span class='op'>=</span><span class='fl'>0</span><span class='op'>)</span>
</div><div class='output co'>#&gt;   year start end
#&gt; 1 2002   127 279
#&gt; 2 2003   125 279
#&gt; 3 2004   116 279
#&gt; 4 2005   124 279
#&gt; 5 2006   126 271
#&gt; 6 2007   124 279
#&gt; 7 2008   125 279
#&gt; 8 2009   115 279
#&gt; 9 2010   116 279</div><div class='input'>
<span class='co'># add column with sum of day degrees in vegetation periods</span>
<span class='fu'>vegperiod</span><span class='op'>(</span>dates<span class='op'>=</span><span class='va'>goe</span><span class='op'>$</span><span class='va'>date</span>, Tavg<span class='op'>=</span><span class='va'>goe</span><span class='op'>$</span><span class='va'>t</span>, Tsum.out<span class='op'>=</span><span class='cn'>TRUE</span>,
          start<span class='op'>=</span><span class='st'>"StdMeteo"</span>, end<span class='op'>=</span><span class='st'>"StdMeteo"</span><span class='op'>)</span>
</div><div class='output co'>#&gt;    year start end   Tsum
#&gt; 1  2001    34 347 3449.9
#&gt; 2  2002    36 329 3263.5
#&gt; 3  2003    65 323 3270.6
#&gt; 4  2004    38 333 3361.4
#&gt; 5  2005    69 327 3222.8
#&gt; 6  2006    18 308 2888.9
#&gt; 7  2007    84 354 3214.7
#&gt; 8  2008    64 322 3270.6
#&gt; 9  2009    48 321 3195.5
#&gt; 10 2010    88 356 3359.2</div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Robert Nuske, Nordwestdeutsche Forstliche Versuchsanstalt (NW-FVA).</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


