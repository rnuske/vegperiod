<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Calculate start and end date of vegetation periods based on daily average
air temperature and the day of the year (DOY).
The sum of day degrees within the vegetation period is included for convenience."><title>Determine vegetation period — vegperiod • vegperiod</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Determine vegetation period — vegperiod"><meta property="og:description" content="Calculate start and end date of vegetation periods based on daily average
air temperature and the day of the year (DOY).
The sum of day degrees within the vegetation period is included for convenience."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">vegperiod</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.3.1.901</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/rnuske/vegperiod/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Determine vegetation period</h1>
      <small class="dont-index">Source: <a href="https://github.com/rnuske/vegperiod/blob/HEAD/R/vegperiod.R" class="external-link"><code>R/vegperiod.R</code></a></small>
      <div class="d-none name"><code>vegperiod.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Calculate start and end date of vegetation periods based on daily average
air temperature and the day of the year (DOY).
The sum of day degrees within the vegetation period is included for convenience.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">vegperiod</span><span class="op">(</span></span>
<span>  <span class="va">dates</span>,</span>
<span>  <span class="va">Tavg</span>,</span>
<span>  <span class="va">start.method</span>,</span>
<span>  <span class="va">end.method</span>,</span>
<span>  Tsum.out <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  Tsum.crit <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  species <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  est.prev <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  check.data <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>dates</dt>
<dd><p>vector of calendar dates (objects of class <code>Date</code> or something
understood by <code><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date()</a></code>). Must contain entire years if <code>est.prev &gt; 0</code>
else the first year may comprise only November and December.</p></dd>


<dt>Tavg</dt>
<dd><p>vector of daily average air temperatures in degree Celsius.
Same length as <code>dates</code>.</p></dd>


<dt>start.method</dt>
<dd><p>name of method to use for vegetation start. One of
<code>"Menzel"</code> (needs additional argument <code>species</code>, see below), <code>"StdMeteo"</code>
resp. <code>"ETCCDI"</code>, <code>"Ribes uva-crispa"</code>. Can be abbreviated (partial
matching). For further discussion see Details.</p></dd>


<dt>end.method</dt>
<dd><p>name of method to use for vegetation end. One of
<code>"vonWilpert"</code>, <code>"LWF-BROOK90"</code>, <code>"NuskeAlbert"</code> and <code>"StdMeteo"</code> resp.
<code>"ETCCDI"</code>. Can be abbreviated (partial matching). For further discussion
see Details.</p></dd>


<dt>Tsum.out</dt>
<dd><p>boolean. Return the sum of daily mean temperatures above
<code>Tsum.crit</code> within vegetation period, also known as growing day degrees.</p></dd>


<dt>Tsum.crit</dt>
<dd><p>threshold for sum of day degrees. Only daily mean temperatures
<code>&gt; Tsum.crit</code> will be tallied. The default of <code>0</code> prevents negative
daily temperatures from reducing the sum. Climate change studies often use
a threshold of <code>5</code>.</p></dd>


<dt>species</dt>
<dd><p>name of tree species (required if <code>start.method="Menzel"</code>
ignored otherwise).</p>
<p>Must be one of <code>"Larix decidua"</code>, <code>"Picea abies (frueh)"</code>,
<code>"Picea abies (spaet)"</code>, <code>"Picea abies (noerdl.)"</code>, <code>"Picea omorika"</code>,
<code>"Pinus sylvestris"</code>, <code>"Betula pubescens"</code>, <code>"Quercus robur"</code>,
<code>"Quercus petraea"</code>, <code>"Fagus sylvatica"</code>.</p></dd>


<dt>est.prev</dt>
<dd><p>number of years to <strong>est</strong>imate <strong>prev</strong>ious year's chill
days for the first year (required if <code>start.method="Menzel"</code> ignored
otherwise).</p>
<p><code>Menzel</code> requires the number of chill days of previous November and
December. If <code>est.prev = 0</code> the first year is used to get the previous
year's chill days and dropped afterwards. Thus, a year from the time
series is lost. To avoid losing a year, <code>est.prev = n</code> estimates the
previous year's chill days for the first year from the average of <code>n</code>
first years of the time series.</p></dd>


<dt>check.data</dt>
<dd><p>Performs plausibility checks on the temperature data to
ensure that the temperatures have not been multiplied by ten.
Plausible range is -35 to +40°C.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A data.frame with year and DOY of start and end day of
vegetation period. If <code>Tsum.out=TRUE</code>, the data.frame contains an
additional column with the sum of day degrees within vegetation periods.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Common methods for determining the onset and end of thermal vegetation
periods are provided, for details see next sections. Popular choices with
regard to forest trees in Germany are <code>Menzel</code> and <code>vonWilpert</code>. Climate
change impact studies at NW-FVA are frequently conducted using <code>Menzel</code> with
"Picea abies (frueh)" and <code>NuskeAlbert</code> for all tree species; with tree
species specifics accounted for in subsequent statistical models.</p><div class="section">
<h3 id="start-methods-">Start methods:<a class="anchor" aria-label="anchor" href="#start-methods-"></a></h3>


<p>The method <strong><code><a href="method_Menzel.html">Menzel</a></code></strong> implements the algorithm described in
Menzel (1997). The method is parameterized for 10 common tree species. It
needs previous year's chill days. <strong><code><a href="method_ETCCDI.html">ETCCDI</a></code></strong> resp.
<code>StdMeteo</code> is a simple threshold based procedure as defined by the
Expert Team on Climate Change Detection and Indices (cf. ETCCDI 2009, Frich
et al. 2002, Zhang et al. 2011) leading to quite early vegetation starts.
This method is widely used in climate change studies. The method
<strong><code><a href="method_Ribes.html">Ribes uva-crispa</a></code></strong> is based on leaf-out of gooseberry (Janssen
2009). It was developed by the Germany's National Meteorological Service
(Deutscher Wetterdienst, DWD) and is more robust against early starts than
common simple meteorological procedures.</p>
</div>

<div class="section">
<h3 id="end-methods-">End methods:<a class="anchor" aria-label="anchor" href="#end-methods-"></a></h3>


<p>The end method <strong><code><a href="method_vonWilpert.html">vonWilpert</a></code></strong> is based on von Wilpert (1990). It
was originally developed for <em>Picea abies</em> in the Black Forest but is
commonly used for all tree species throughout Germany. As usual, the rules
regarding the soilmatrix are neglected in this implementation.
<strong><code><a href="method_LWF-BROOK90.html">LWF-BROOK90</a></code></strong> is -for the sake of convenience- a
reimplementation of the LWF-BROOK90 VBA (version 3.4) variant of "vonWilpert"
(Hammel and Kennel 2001). Their interpretation of von Wilpert (1990) and the
somewhat lower precision of VBA was mimicked. <strong><code><a href="method_NuskeAlbert.html">NuskeAlbert</a></code></strong>
provide a very simple method which is inspired by standard climatological
procedures but employs a 7 day moving average and a 5 °C threshold (cf.
Walther and Linderholm 2006). <strong><code><a href="method_ETCCDI.html">ETCCDI</a></code></strong> resp. <code>StdMeteo</code>
is a simple threshold based procedure as defined by the Expert Team on
Climate Change Detection and Indices (cf. ETCCDI 2009, Frich et al. 2002,
Zhang et al. 2011) leading to quite late vegetation ends.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>ETCCDI (2009)
Climate Change Indices: Definitions of the 27 core indices.
<a href="http://etccdi.pacificclimate.org/list_27_indices.shtml" class="external-link">http://etccdi.pacificclimate.org/list_27_indices.shtml</a></p>
<p>Frich, P., Alexander, L., Della-Marta, P., Gleason, B., Haylock, M.,
Klein Tank, A. and Peterson, T. (2002)
Observed coherent changes in climatic extremes during the second half of
the twentieth century.
<em>Climate Research</em>, <b>19</b>, 193--212.
<a href="https://doi.org/10.3354/cr019193" class="external-link">doi:10.3354/cr019193</a>
.</p>
<p>Hammel, K. and Kennel, M. (2001)
Charakterisierung und Analyse der Wasserverfügbarkeit und des
Wasserhaushalts von Waldstandorten in Bayern mit dem Simulationsmodell
BROOK90.
<em>Forstliche Forschungsberichte München</em>.</p>
<p>Janssen, W. (2009)
Definition des Vegetationsanfanges.
<em>Internal Report, Deutscher Wetterdienst, Abteilung Agrarmeteorologie</em>.</p>
<p>Menzel, A. (1997)
Phänologie von Waldbäumen unter sich ändernden Klimabedingungen -
Auswertung der Beobachtungen in den Internationalen Phänologischen Gärten
und Möglichkeiten der Modellierung von Phänodaten.
<em>Forstliche Forschungsberichte München</em>.</p>
<p>von Wilpert, K. (1990)
Die Jahrringstruktur von Fichten in Abhängigkeit vom Bodenwasserhaushalt
auf Pseudogley und Parabraunerde: Ein Methodenkonzept zur Erfassung
standortsspezifischer Wasserstreßdispostion.
<em>Freiburger Bodenkundliche Abhandlungen</em>.</p>
<p>Walther, A. and Linderholm, H. W. (2006)
A comparison of growing season indices for the Greater Baltic Area.
<em>International Journal of Biometeorology</em>, <b>51</b>(2), 107--118.
<a href="https://doi.org/10.1007/s00484-006-0048-5" class="external-link">doi:10.1007/s00484-006-0048-5</a>
.</p>
<p>Zhang, X., Alexander, L., Hegerl, G. C., Jones, P., Tank, A. K.,
Peterson, T. C., Trewin, B. and Zwiers, F. W. (2011)
Indices for monitoring changes in extremes based on daily temperature and
precipitation data.
<em>Wiley Interdisciplinary Reviews: Climate Change</em>, <b>2</b>(6), 851--870.
<a href="https://doi.org/10.1002/wcc.147" class="external-link">doi:10.1002/wcc.147</a>
.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">goe</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">vegperiod</span><span class="op">(</span>dates<span class="op">=</span><span class="va">goe</span><span class="op">$</span><span class="va">date</span>, Tavg<span class="op">=</span><span class="va">goe</span><span class="op">$</span><span class="va">t</span>,</span></span>
<span class="r-in"><span>          start.method<span class="op">=</span><span class="st">"Menzel"</span>, end.method<span class="op">=</span><span class="st">"vonWilpert"</span>,</span></span>
<span class="r-in"><span>          species<span class="op">=</span><span class="st">"Picea abies (frueh)"</span>, est.prev<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    year start end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2001   119 274</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  2002   127 279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  2003   125 279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  2004   116 279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  2005   124 279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  2006   126 271</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  2007   124 279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  2008   125 279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  2009   115 279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 2010   116 279</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># take chill days from first year, which is then dropped</span></span></span>
<span class="r-in"><span><span class="fu">vegperiod</span><span class="op">(</span>dates<span class="op">=</span><span class="va">goe</span><span class="op">$</span><span class="va">date</span>, Tavg<span class="op">=</span><span class="va">goe</span><span class="op">$</span><span class="va">t</span>, start<span class="op">=</span><span class="st">"Menzel"</span>, end<span class="op">=</span><span class="st">"vonWilpert"</span>,</span></span>
<span class="r-in"><span>          species<span class="op">=</span><span class="st">"Picea abies (frueh)"</span>, est.prev<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   year start end</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2002   127 279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 2003   125 279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 2004   116 279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 2005   124 279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 2006   126 271</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 2007   124 279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7 2008   125 279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8 2009   115 279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9 2010   116 279</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># add column with sum of day degrees in vegetation periods</span></span></span>
<span class="r-in"><span><span class="fu">vegperiod</span><span class="op">(</span>dates<span class="op">=</span><span class="va">goe</span><span class="op">$</span><span class="va">date</span>, Tavg<span class="op">=</span><span class="va">goe</span><span class="op">$</span><span class="va">t</span>, Tsum.out<span class="op">=</span><span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>          start<span class="op">=</span><span class="st">"StdMeteo"</span>, end<span class="op">=</span><span class="st">"StdMeteo"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    year start end   Tsum</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  2001    34 347 3474.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2  2002    36 329 3273.8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  2003    65 323 3273.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4  2004    38 333 3361.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5  2005    69 327 3229.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6  2006    18 308 2891.6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7  2007    84 354 3216.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8  2008    64 322 3273.7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9  2009    48 321 3195.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10 2010    88 356 3359.8</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Robert Nuske, Nordwestdeutsche Forstliche Versuchsanstalt (NW-FVA).</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

